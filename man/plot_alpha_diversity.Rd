% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/binary-analysis_alpha.R
\name{plot_alpha_diversity}
\alias{plot_alpha_diversity}
\alias{plot_alpha_diversity.phip_data}
\alias{plot_alpha_diversity.data.frame}
\alias{plot_alpha_diversity.phip_alpha_diversity}
\title{Plot alpha diversity (cross-sectional or longitudinal)}
\usage{
plot_alpha_diversity(x, ...)

\method{plot_alpha_diversity}{phip_data}(
  x,
  metric = c("richness", "shannon_diversity", "simpson_diversity"),
  group_col = "group",
  rank_col = "rank",
  filter_groups = NULL,
  filter_ranks = NULL,
  custom_colors = NULL,
  facet_by_rank = TRUE,
  ncol = 2,
  facet_scales = "fixed",
  time_col = NULL,
  continuous_mode = c("gam", "binned", "loess"),
  gam_k = 7,
  point_alpha = 0.25,
  ci_method = c("model", "bootstrap"),
  ci_level = 0.95,
  boot_R = 500,
  boot_seed = NULL,
  boot_progress = TRUE,
  ci_fill = "grey70",
  ci_alpha = 0.15,
  ...
)

\method{plot_alpha_diversity}{data.frame}(
  x,
  metric = c("richness", "shannon_diversity", "simpson_diversity"),
  group_col = "group",
  rank_col = "rank",
  filter_groups = NULL,
  filter_ranks = NULL,
  custom_colors = NULL,
  facet_by_rank = TRUE,
  ncol = 2,
  facet_scales = "fixed",
  time_col = NULL,
  continuous_mode = c("gam", "binned", "loess"),
  gam_k = 7,
  point_alpha = 0.25,
  ci_method = c("model", "bootstrap"),
  ci_level = 0.95,
  boot_R = 500,
  boot_seed = NULL,
  boot_progress = TRUE,
  ci_fill = "grey70",
  ci_alpha = 0.15,
  ...
)

\method{plot_alpha_diversity}{phip_alpha_diversity}(
  x,
  metric = c("richness", "shannon_diversity", "simpson_diversity"),
  group_col = "group",
  rank_col = "rank",
  filter_groups = NULL,
  filter_ranks = NULL,
  custom_colors = NULL,
  facet_by_rank = TRUE,
  ncol = 2,
  facet_scales = "fixed",
  time_col = NULL,
  continuous_mode = c("gam", "binned", "loess"),
  gam_k = 7,
  point_alpha = 0.25,
  ci_method = c("model", "bootstrap"),
  ci_level = 0.95,
  boot_R = 500,
  boot_seed = NULL,
  boot_progress = TRUE,
  ci_fill = "grey70",
  ci_alpha = 0.15,
  ...
)
}
\arguments{
\item{x}{Input object: a \verb{<phip_data>}, a long \code{data.frame}, or a
precomputed \strong{\code{phip_alpha_diversity}}.}

\item{metric}{Character vector of metrics to plot. Allowed values:
\code{"richness"}, \code{"shannon_diversity"}, \code{"simpson_diversity"}.
Case-insensitive. If multiple are given, one plot per metric is returned.}

\item{group_col}{Name of the grouping column in the \strong{alpha} data. For
objects computed by \code{\link[=compute_alpha_diversity]{compute_alpha_diversity()}} the default is \code{"group"}.
Use \code{NULL} to plot without grouping (single colour/curve).}

\item{rank_col}{Name of the rank column in the \strong{alpha} data (default
\code{"rank"}). Used only for faceting and optional filtering.}

\item{filter_groups}{Optional character vector. If provided, only these
groups are retained \strong{for plotting}.}

\item{filter_ranks}{Optional character vector. If provided, only these ranks
are retained \strong{for plotting}.}

\item{custom_colors}{Optional named vector of colours for groups. If omitted,
PHIP palette/scales are used.}

\item{facet_by_rank}{Logical; facet by \code{rank} if there is more than one level
(default \code{TRUE}).}

\item{ncol}{Facet column count when \code{facet_by_rank = TRUE} (default \code{2}).}

\item{facet_scales}{Facet scales, passed to \code{ggplot2::facet_wrap()}; one of
\code{"fixed"}, \code{"free_x"}, \code{"free_y"}, \code{"free"}. Default \code{"fixed"}.}

\item{time_col}{Optional name of a time/age variable (numeric, Date, or
POSIXt). If provided, the plot switches to longitudinal mode.}

\item{continuous_mode}{One of \code{"gam"}, \code{"binned"}, \code{"loess"} (default
\code{"gam"}). \code{"gam"} uses \code{mgcv::gam()} with per-series safe k. \code{"binned"}
summarizes within time bins. \code{"loess"} draws a LOESS smoother.}

\item{gam_k}{Requested GAM basis size k (per series). The effective k is
auto-shrunk to \verb{k_eff ≤ n_unique(x)-1} (min 3). Default \code{7}.}

\item{point_alpha}{Alpha for raw points overlay (default \code{0.25}; set \code{0} to
hide points).}

\item{ci_method}{\code{"model"} (default) or \code{"bootstrap"}.}

\item{ci_level}{Confidence level for bands (default \code{0.95}).}

\item{boot_R}{Number of bootstrap replicates when \code{ci_method="bootstrap"}
(default \code{500}).}

\item{boot_seed}{Optional integer seed for bootstrap reproducibility.}

\item{boot_progress}{Logical; show a textual progress bar during bootstrap
(default \code{TRUE}).}

\item{ci_fill}{Fill colour for ribbons (default \code{"grey70"}).}

\item{ci_alpha}{Alpha for ribbons (default \code{0.15}).}
}
\value{
A single \code{ggplot} object or a \strong{named list} of plots (when multiple
\code{metric} values are provided).
}
\description{
Visualize per-sample \strong{alpha diversity} (e.g., \emph{richness},
\emph{Shannon}, \emph{Simpson}) across groups and peptide ranks.
\itemize{
\item For \verb{<phip_data>} and long \code{data.frame} inputs, the function first calls
\code{\link[=compute_alpha_diversity]{compute_alpha_diversity()}} to produce a tidy summary and then plots it.
\item For a precomputed object of class \strong{\code{phip_alpha_diversity}}, it plots
directly (no recomputation).
}

Styling defaults to \code{theme_phip()} and PHIP colour/fill scales unless you
provide \code{custom_colors}.
}
\section{Metrics & ranks}{

Allowed metrics are \strong{"richness"}, \strong{"shannon_diversity"},
\strong{"simpson_diversity"} (case-insensitive). If you pass several metrics,
a \strong{separate plot} is returned for each.

Ranks are the peptide features you aggregated over when computing alpha
diversity (e.g., \code{"peptide_id"}, \code{"genus"}, \code{"species"}, …). The plotting
interface expects the result column to be named \code{rank} (this is the default
of \code{\link[=compute_alpha_diversity]{compute_alpha_diversity()}}).
}

\section{Longitudinal mode}{

Provide \code{time_col} to enable longitudinal plots. For the \strong{\code{phip_data}}
method, longitudinal mode is allowed \strong{only} if \code{x$meta$longitudinal} is
\code{TRUE}. For \code{data.frame} and \code{phip_alpha_diversity}, no such guard is
enforced.

Continuous curves use GAM smoothing with an \strong{auto-shrunk per-series k}
(\verb{k_eff ≤ n_unique(x)-1}, min 3) to avoid over-parameterization. Confidence
bands are either \strong{model-based} (\code{ci_method = "model"}) or \strong{bootstrap}
(\code{"bootstrap"} with progress bar via \code{boot_progress = TRUE}).
}

\section{Longitudinal options}{

}

\section{Confidence bands}{

}

\concept{phip-plotting}

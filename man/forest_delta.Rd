% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prevalence-DELTA_plots.R
\name{forest_delta}
\alias{forest_delta}
\title{Forest plot of top/bottom raw Stouffer T by rank (with arrows)}
\usage{
forest_delta(
  x,
  rank_of_interest,
  n_each = NULL,
  n_neg_each = 15,
  n_pos_each = 15,
  color = FALSE,
  filter_significant = "none",
  sig_level = 0.05,
  add_signed_z_from_p = FALSE,
  left_label = "More in group1",
  right_label = "More in group2",
  arrow_frac = 0.35,
  text_gap_frac = 0.06,
  y_pad = 0.6,
  text_y_offset = 0,
  text_vjust = -0.3,
  arrow_color = "red",
  arrow_lwd = 0.6,
  arrow_head_cm = 0.3,
  base_text_pt = 12,
  font_family = "Montserrat",
  seg_width = 1.2,
  point_size = 3.6,
  show_grid = FALSE
)
}
\arguments{
\item{x}{A data frame/tibble with at least:
\verb{rank, feature, group1, group2, design, T_obs, p_perm, p_adj_rank, category_rank_bh}.}

\item{rank_of_interest}{Character scalar, e.g. \code{"species"}.}

\item{n_each}{Integer; how many items from negative and positive tails (default 15).}

\item{color}{Logical; if \code{TRUE}, lines/points are shaded blue (left, T<0) to
red (right, T>0) with higher contrast; otherwise monochrome.}

\item{filter_significant}{character; name of the column to filter on, or \code{"none"} to disable filtering.
if the named column is numeric, rows are kept where \code{col <= sig_level}.
if the named column is non-numeric (e.g., \code{category_rank_bh}), rows are kept where
\code{col == "significant (BH, per rank)"}. default: \code{"none"}.}

\item{sig_level}{numeric; significance threshold used when \code{filter_significant} is a numeric column (default 0.05).}

\item{add_signed_z_from_p}{Logical; if \code{TRUE}, computes a signed Z from
permutation p (\code{sign(T_obs) * qnorm(1 - p_perm/2)}) and returns it in data.}

\item{left_label}{Text for the left arrow/side label.}

\item{right_label}{Text for the right arrow/side label.}

\item{arrow_frac}{Fraction of max |T_obs| used as half-length of arrows.}

\item{text_gap_frac}{Horizontal gap for arrow labels beyond arrow tips (fraction of max |T_obs|).}

\item{y_pad}{Vertical padding above the top category for arrows/labels (in y units).}

\item{text_y_offset}{Additional vertical offset for arrow-end labels (in y units).}

\item{text_vjust}{Passed to \code{annotate("text", vjust=...)} (default -0.30).}

\item{arrow_color}{Arrow/label color.}

\item{arrow_lwd}{Arrow line width.}

\item{arrow_head_cm}{Arrow head length in cm.}

\item{text_size}{Arrow-end label size (ggplot2 size units).}
}
\value{
A list with:
\itemize{
\item \code{data} – tibble used for plotting (selected top/bottom items),
\item \code{plot} – ggplot object.
}
}
\description{
Builds a forest plot for the most extreme DELTA/Stouffer results within a
chosen rank using the \strong{raw} \code{T_obs} (no division by any SD). Rows can be
optionally filtered by a significance column (e.g., \code{p_adj_rank}, \code{padj_wbh})
with a user-specified threshold.
}
\details{
\itemize{
\item \code{T_obs} here is plotted \strong{as is} (raw Stouffer statistic from your shift).
\item For calibrated inference or cross-figure comparability, prefer permutation
p-values (optionally expose \code{add_signed_z_from_p=TRUE} for reporting).
}
}

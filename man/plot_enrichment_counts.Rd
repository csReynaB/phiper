% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/binary-analysis_alpha.R
\name{plot_enrichment_counts}
\alias{plot_enrichment_counts}
\alias{plot_enrichment_counts.phip_data}
\alias{plot_enrichment_counts.data.frame}
\title{Plot enrichment counts by cohort/group}
\usage{
plot_enrichment_counts(
  phip_data,
  group_cols = NULL,
  prevalence_threshold = 0.05,
  custom_colors = NULL,
  binwidth = 1,
  group_interaction = FALSE,
  interaction_sep = " * ",
  ...
)

\method{plot_enrichment_counts}{phip_data}(
  phip_data,
  group_cols = NULL,
  prevalence_threshold = 0.05,
  custom_colors = NULL,
  binwidth = 1,
  group_interaction = FALSE,
  interaction_sep = " * ",
  ...
)

\method{plot_enrichment_counts}{data.frame}(
  phip_data,
  group_cols = NULL,
  prevalence_threshold = 0.05,
  custom_colors = NULL,
  binwidth = 1,
  group_interaction = FALSE,
  interaction_sep = " * ",
  ...
)
}
\arguments{
\item{phip_data}{A \verb{<phip_data>} object \strong{or} a long \code{data.frame} with
columns \code{sample_id}, \code{peptide_id}, \code{exist} (0/1 or logical), and the
grouping column(s) when \code{group_cols} is not \code{NULL}.}

\item{group_cols}{Character vector of grouping column names, or \code{NULL}
(no facets; one aggregate plot).}

\item{prevalence_threshold}{Numeric in \verb{[0, 1]}. Fraction of cohort size used
for the dashed horizontal \strong{prevalence} line (default \code{0.05}). \strong{Note}:
presence per sample is defined as \code{exist > 0} and is not affected by this
parameter.}

\item{custom_colors}{Optional named vector of hex colors to override the PHIP
palette (used only if provided).}

\item{binwidth}{Histogram bin width for \verb{# of individuals} (x-axis).}

\item{group_interaction}{Logical; also plot the \strong{interaction} of all
\code{group_cols} (default \code{FALSE}).}

\item{interaction_sep}{Separator string between interaction parts
(default \code{" × "}).}

\item{...}{Reserved.}
}
\value{
A single \code{ggplot} (when a single plot is produced) or a named list
of \code{ggplot} objects (one per grouping column, plus optional interaction).
}
\description{
For each cohort (level of a grouping variable), draw a histogram
of how many individuals a peptide is present in. A dashed horizontal line
marks a \strong{prevalence threshold} equal to \code{ceiling(n_samples * prevalence_threshold)}, with two labels:
\itemize{
\item “\strong{N peptides in ≥threshold}” (above the dashed line)
\item “\strong{M peptides overall}” (below; peptides with ≥1 present sample)
}
}
\details{
Works with a \verb{<phip_data>} object or a long \code{data.frame}.
\itemize{
\item If \code{group_cols} is a character vector, a \strong{separate plot} is created for
each grouping column.
\item If \code{group_cols = NULL}, a \strong{single non-facetted} plot over all samples is
returned.
\item If \code{group_interaction = TRUE} and \code{length(group_cols) >= 2}, an additional
plot for the \strong{interaction} of all \code{group_cols} is appended.

Styling defaults to \code{theme_phip()} and the \strong{PHIP palette}. Colors are
applied deterministically by attaching hex values to the data and using
\code{scale_fill_identity()}, preventing ggplot from overriding hues.
}
}
\section{Grouping columns}{

For the \verb{<phip_data>} method, all requested \code{group_cols} must be present in
\code{x$data_long}. If any grouping column is missing, the function aborts with a
phiper-style error explaining which columns are missing.
}

\examples{
\dontrun{
# phip_data input
plot_enrichment_counts(pd,
  group_cols = "Cohort",
  prevalence_threshold = 0.05
)

# no facets (aggregate over all samples)
plot_enrichment_counts(pd, group_cols = NULL)

# data.frame input + interaction
plot_enrichment_counts(df_long,
  group_cols = c("Cohort", "timepoint"),
  group_interaction = TRUE
)
}
}

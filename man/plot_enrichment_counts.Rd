% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/binary_alpha_plots.R
\name{plot_enrichment_counts}
\alias{plot_enrichment_counts}
\title{Plot enrichment counts per group (and optional interaction)}
\usage{
plot_enrichment_counts(
  phip_data,
  group_cols = NULL,
  prevalence_threshold = 0.05,
  custom_colors = NULL,
  binwidth = 1,
  group_interaction = FALSE,
  interaction_only = FALSE,
  interaction_sep = " * ",
  ...
)
}
\arguments{
\item{phip_data}{A \verb{<phip_data>} object with \code{data_long} containing at least
\code{sample_id}, \code{peptide_id}, and \code{exist}.}

\item{group_cols}{Character vector of grouping columns in \code{data_long}, or
\code{NULL} to plot all samples together.}

\item{prevalence_threshold}{Numeric in \verb{[0,1]}; minimum prevalence used by
\code{.plot_enrichment_counts_one()} to filter/annotate bins (default \code{0.05}).}

\item{custom_colors}{Optional named vector for group colors passed through to
\code{.plot_enrichment_counts_one()} (default \code{NULL}).}

\item{binwidth}{Numeric bin width for histograms (default \code{1}).}

\item{group_interaction}{Logical; also compute a plot for the interaction of
all \code{group_cols} (default \code{FALSE}).}

\item{interaction_only}{Logical; if \code{TRUE}, return only the interaction plot
(requires \code{group_interaction = TRUE} and at least two \code{group_cols}).}

\item{interaction_sep}{Character separator for interaction labels (default \code{" * "}).}

\item{...}{Reserved for future extensions; ignored.}
}
\value{
\itemize{
\item A single plot object (when \code{group_cols = NULL}, or when only one plot is
produced), or
\item A named list of plot objects (when multiple plots are produced).
}
}
\description{
Visualizes per-sample peptide enrichment counts across groups in a
\verb{<phip_data>} object, with optional interaction of multiple grouping
variables. Presence is defined by \code{exist > 0}. The plot(s) are produced by
an internal helper \code{.plot_enrichment_counts_one()}.
}
\details{
\itemize{
\item If \code{group_cols = NULL}, a single plot is returned for all samples.
\item If \code{group_cols} is a character vector, a list of plots is returned (one per
grouping column) unless \code{interaction_only = TRUE}.
\item If \code{group_interaction = TRUE} and at least two \code{group_cols} are supplied,
an additional interaction plot is created whose label joins groups using
\code{interaction_sep}.
\item If \code{interaction_only = TRUE}, only the interaction plot is returned (this
requires \code{group_interaction = TRUE} and at least two \code{group_cols}).
}
}
\examples{
\dontrun{
# per-group plots
p <- plot_enrichment_counts(pd, group_cols = c("Cohort","timepoint"))

# add interaction plot
p2 <- plot_enrichment_counts(pd,
  group_cols = c("Cohort","timepoint"),
  group_interaction = TRUE
)

# interaction only
p3 <- plot_enrichment_counts(pd,
  group_cols = c("Cohort","timepoint"),
  group_interaction = TRUE,
  interaction_only = TRUE
)
}
}

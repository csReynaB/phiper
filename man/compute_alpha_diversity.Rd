% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/binary_alpha.R
\name{compute_alpha_diversity}
\alias{compute_alpha_diversity}
\alias{compute_alpha_diversity.phip_data}
\alias{compute_alpha_diversity.data.frame}
\title{Compute alpha diversity per sample / group across ranks}
\usage{
compute_alpha_diversity(x, ...)

\method{compute_alpha_diversity}{phip_data}(
  x,
  group_cols = NULL,
  ranks = "peptide_id",
  fc_threshold = NULL,
  shannon_log = c("ln", "log2", "log10"),
  carry_cols = NULL,
  group_interaction = FALSE,
  interaction_sep = " * "
)

\method{compute_alpha_diversity}{data.frame}(
  x,
  group_cols = NULL,
  ranks = "peptide_id",
  fc_threshold = NULL,
  shannon_log = c("ln", "log2", "log10"),
  carry_cols = NULL,
  group_interaction = FALSE,
  interaction_sep = " * "
)
}
\arguments{
\item{x}{A \verb{<phip_data>} object or a long \code{data.frame}.}

\item{group_cols}{Character vector of grouping columns, or \code{NULL} for a
single aggregate (non-facetted) table. \strong{All columns must be present} on
the input.}

\item{ranks}{Character vector of \strong{exact column names} to aggregate by (see
“What are ranks?”). Typical defaults include \code{"peptide_id"} or taxonomy /
lineage columns present in your peptide library or data frame.}

\item{fc_threshold}{Numeric or \code{NULL}. If \code{NULL} (default), presence is
\code{exist > 0}. If numeric, presence is \code{fold_change > fc_threshold}.}

\item{shannon_log}{One of \code{"ln"}, \code{"log2"}, \code{"log10"}; reporting base for the
Shannon index (via base change from natural log).}

\item{carry_cols}{Optional character vector of extra columns to carry forward
into the output if present (e.g., sample metadata already in your table).}

\item{group_interaction}{Logical; also compute the \strong{interaction} of all
\code{group_cols} (default \code{FALSE}).}

\item{interaction_sep}{Separator used for the interaction label (default \code{" * "}).}
}
\value{
A \strong{named list} of data frames with S3 class
\code{"phip_alpha_diversity"}. Each element (per \code{group_col}, plus optional
interaction or \code{"all_samples"}) contains: \code{sample_id}, the grouping column
(or \code{group} when \code{group_cols = NULL}), any \code{carry_cols}, and the metrics:
\code{rank}, \code{richness}, \code{shannon_diversity}, \code{simpson_diversity}.
}
\description{
Computes \strong{richness}, \strong{Shannon}, and \strong{Simpson} diversity
per sample and grouping variable at one or more \strong{ranks} (columns) that
describe peptides.
}
\details{
\subsection{What are “ranks” here? Ranks are *the peptide identities or}{

characteristics you aggregate by. They must be \strong{exact column names}:
\itemize{
\item For \verb{<phip_data>}: columns in the PHIPER peptide library from Vogl Lab
(e.g., \code{peptide_id}, lineage/taxa fields available in your library).
\item For \code{data.frame}: columns present on your long count table.
}
}

\subsection{Presence rule}{
\itemize{
\item Default: \code{exist > 0}.
\item If \code{fc_threshold} is numeric, presence is instead \code{fold_change > fc_threshold}.
}
}

\subsection{Grouping & interactions}{
\itemize{
\item \code{group_cols} can be a character vector; the return value is a \strong{named list}
of data frames, one per \code{group_col}.
\item If \code{group_cols = NULL}, a single non-facetted table is returned under the
name \code{"all_samples"}.
\item If \code{group_interaction = TRUE} (and you supplied ≥ 2 \code{group_cols}), an
additional element is computed for the interaction of all group columns, with
labels joined by \code{interaction_sep}.
}
}
}
\examples{
\dontrun{
# phip_data input — peptide-level diversity by cohort
out <- compute_alpha_diversity(pd,
  group_cols = "Cohort",
  ranks = "peptide_id"
)

# Use ranks present in the peptide library (e.g., lineage/taxa)
out_taxa <- compute_alpha_diversity(pd,
  group_cols = c("Cohort", "timepoint"),
  ranks = c("peptide_id", "family", "genus"),
  group_interaction = TRUE
)

# data.frame input — ranks must be columns in the data
out_df <- compute_alpha_diversity(df_long,
  group_cols = NULL,
  ranks = "peptide_id"
)

# Presence via fold-change
out_fc <- compute_alpha_diversity(pd,
  group_cols = "Cohort",
  ranks = "peptide_id",
  fc_threshold = 1.5
)
}
}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/binary-analysis_stability.R
\name{ph_plot_stability_corr_heatmap}
\alias{ph_plot_stability_corr_heatmap}
\title{Correlation heatmap of repertoire \emph{stability} trajectories (subjects × subjects)}
\usage{
ph_plot_stability_corr_heatmap(
  stab,
  group = NULL,
  min_times = 2,
  method = c("pearson", "spearman"),
  require_shared_times = TRUE,
  sort_by_status = FALSE,
  subject_meta = NULL,
  pre_status_col = "status_t1",
  post_status_col = "status_t2",
  palette = "RdYlBu",
  limits = c(-1, 1)
)
}
\arguments{
\item{stab}{A tibble of class \code{"phip_repertoire_stability"} with cols:
\code{subject_id}, \code{group}, \code{time}, \code{similarity}. Baseline rows
may have been dropped depending on compute settings.}

\item{group}{Character scalar or NULL. If provided, filter to this group
level (matching \code{stab$group}). If NULL, all groups pooled.}

\item{min_times}{Integer; require at least this many time points per subject
to be included (default 2).}

\item{method}{"pearson" (default) or "spearman".}

\item{require_shared_times}{Logical; if TRUE, keep only \strong{timepoints shared by
at least 2 subjects} (reduces spurious ±1 from singletons).}

\item{sort_by_status}{Logical; if TRUE, order subjects by status columns.}

\item{subject_meta}{Optional tibble with \code{subject_id} plus optional
\code{pre_status_col}, \code{post_status_col} used when sorting.}

\item{pre_status_col, post_status_col}{Character names in \code{subject_meta}
for ordering (defaults: "status_t1","status_t2").}

\item{palette}{Diverging palette for fill scale (default "RdYlBu").}

\item{limits}{Numeric length-2 for color scale; default c(-1, 1).}
}
\value{
A ggplot object; invisibly a list(list(plot=..., corr_matrix=...,
subjects=..., order_info=...)).
}
\description{
Given a tibble produced by \code{\link[=compute_repertoire_similarity]{compute_repertoire_similarity()}}, compute
pairwise correlations between \strong{subjects' stability time series} (0..1)
within an optional group and plot a heatmap.

Each subject is a vector over time: \code{similarity(time)} vs their baseline.
We correlate those vectors between subjects using Pearson/Spearman with
pairwise-complete handling of missing time points.
}

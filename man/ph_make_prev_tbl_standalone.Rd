% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prevalence-DELTA_plots.R
\name{ph_make_prev_tbl_standalone}
\alias{ph_make_prev_tbl_standalone}
\title{Build per-peptide prevalence for a chosen rank/feature and two groups (standalone)}
\usage{
ph_make_prev_tbl_standalone(
  x,
  rank = "is_flagellum",
  feature_value = TRUE,
  group_col = "timepoint_factor",
  groups = c("T2", "T8"),
  labels = c("B", "M12"),
  filter = list(),
  eps = 0.5,
  den_mult = 2
)
}
\arguments{
\item{x}{A \code{phip_data} object with \code{data_long} and \code{peptide_library}.}

\item{rank}{Peptide-library column to filter on (e.g. \code{"species"} or \code{"is_flagellum"}).}

\item{feature_value}{Value(s) to keep in \code{rank} (e.g. \code{"Acadevirus PM93"},
\code{TRUE}, or a character vector). Character/logical matching is case-insensitive.}

\item{group_col}{Column in \code{x$data_long} defining groups (default \code{"timepoint_factor"}).}

\item{groups}{Character(2) with the two groups to compare, e.g. \code{c("T2","T8")}.}

\item{labels}{Character(2) display labels for those groups (default \code{c("B","M12")}).}

\item{filter}{Optional named list of simple equality filters applied to \code{x$data_long}
before computing prevalences, e.g. \code{list(big_group = "kid_serum")} or
\code{list(site = c("gut","oral"))}. (Uses \code{\%in\%}.)}

\item{eps}{Laplace numerator epsilon (default \code{0.5}).}

\item{den_mult}{Denominator epsilon multiplier (default \code{2}).}
}
\value{
A tibble with columns: \code{peptide_id}, \code{Group} (display label),
and \code{Prevalence} (smoothed, in 0â€“1).
}
\description{
Construct a long per-peptide prevalence table for a specific \code{rank} value
(e.g., a species or a boolean annotation) comparing two groups in
\code{x$data_long}. Works directly with \code{phip_data} that carries a
\code{peptide_library}, without calling any other helper.
}
\examples{
# Species example (case-insensitive match), kid_serum, T2 vs T8 labeled B/M12:
prev_tbl <- ph_make_prev_tbl_standalone(
  x = ps_merged_box_bin,
  rank = "species",
  feature_value = "Acadevirus PM93",
  group_col = "timepoint_factor",
  groups = c("T2","T8"),
  labels = c("B","M12"),
  filter = list(big_group = "kid_serum")
)
# Now plot with your delta plotter:
# deltaplot_prevalence(prev_tbl, group_order = c("B","M12"))

}

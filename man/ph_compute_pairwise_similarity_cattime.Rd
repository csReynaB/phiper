% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/binary-analysis_stability_cattime.R
\name{ph_compute_pairwise_similarity_cattime}
\alias{ph_compute_pairwise_similarity_cattime}
\title{Pairwise repertoire similarity across categorical time}
\usage{
ph_compute_pairwise_similarity_cattime(
  x,
  time_col,
  group_col = NULL,
  value_col = c("exist", "relative", "fold_change"),
  methods = c("jaccard"),
  compare_mode = c("within_group", "within_time", "mixed"),
  timepairs = NULL,
  min_features = 1L,
  zero_fill_for_pearson = TRUE,
  write_duckdb = FALSE,
  register_name = NULL,
  collect = TRUE
)
}
\arguments{
\item{x}{<phip_data>; must be longitudinal.}

\item{time_col}{Categorical time column name in \code{x$data_long}.}

\item{group_col}{Optional column in \code{x$data_long} defining groups (or NULL).}

\item{value_col}{One of "exist","relative","fold_change".}

\item{methods}{Any of: "jaccard","sorensen","kulczynski","braycurtis","pearson".}

\item{compare_mode}{When \code{group_col} is set: "within_group","within_time","mixed".}

\item{timepairs}{Optional tibble/data.frame with cols \code{time1},\code{time2} (character).}

\item{min_features}{Integer ≥0; require ≥ this many nonzero features per (subject,time).}

\item{zero_fill_for_pearson}{Logical; zero-fill union for Pearson (default TRUE).}

\item{write_duckdb}{Logical; if TRUE, write result to DuckDB via \code{x$meta$con}.}

\item{register_name}{Table name to write when \code{write_duckdb=TRUE}.}

\item{collect}{Logical; collect local tibble at the end (default TRUE).}
}
\value{
Long tibble: method,time1,time2,group1,group2,subject1,subject2,similarity
}
\description{
Compute subject×subject similarities between repertoires at pairs of
categorical timepoints. Supports Jaccard, Sorensen, Kulczynski (binary),
Bray–Curtis (abundance), and Pearson (zero-fill union).

Modes with group_col:
\itemize{
\item "within_group": all timepoint pairs inside each group
\item "within_time" : at each time, all group pairs present at that time
\item "mixed"       : label = paste(group,time); all label pairs
}
}
